{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "canonical-event.schema.json",
  "title": "Canonical Hook Event",
  "description": "Normalized event format for cross-tool hook processing",
  "type": "object",
  "required": ["event_type", "source"],
  "properties": {
    "event_type": {
      "type": "string",
      "description": "Type of hook event",
      "enum": [
        "PreToolUse",
        "PostToolUse",
        "SessionStart",
        "SessionEnd",
        "Stop",
        "UserPromptSubmit",
        "PermissionRequest"
      ]
    },
    "source": {
      "type": "string",
      "description": "Source tool that triggered the event (detected, not claimed)",
      "enum": ["claude", "gemini", "cursor", "opencode", "windsurf", "zed"]
    },
    "session_id": {
      "type": "string",
      "description": "Unique session identifier"
    },
    "cwd": {
      "type": "string",
      "description": "Current working directory"
    },
    "tool_name": {
      "type": "string",
      "description": "Name of the tool being invoked",
      "examples": ["Bash", "Write", "Edit", "Read", "Grep", "Glob"]
    },
    "tool_input": {
      "type": "object",
      "description": "Input parameters for the tool",
      "additionalProperties": true
    },
    "timestamp": {
      "type": "string",
      "description": "ISO 8601 timestamp of the event",
      "format": "date-time"
    },
    "raw_payload": {
      "type": "object",
      "description": "Original payload from the source tool",
      "additionalProperties": true
    }
  },
  "definitions": {
    "toolInput": {
      "bash": {
        "type": "object",
        "properties": {
          "command": {
            "type": "string",
            "description": "Shell command to execute"
          },
          "timeout": {
            "type": "integer",
            "description": "Timeout in milliseconds"
          }
        },
        "required": ["command"]
      },
      "write": {
        "type": "object",
        "properties": {
          "file_path": {
            "type": "string",
            "description": "Absolute path to the file"
          },
          "content": {
            "type": "string",
            "description": "Content to write"
          }
        },
        "required": ["file_path", "content"]
      },
      "edit": {
        "type": "object",
        "properties": {
          "file_path": {
            "type": "string",
            "description": "Absolute path to the file"
          },
          "old_string": {
            "type": "string",
            "description": "String to replace"
          },
          "new_string": {
            "type": "string",
            "description": "Replacement string"
          }
        },
        "required": ["file_path", "old_string", "new_string"]
      }
    }
  },
  "examples": [
    {
      "event_type": "PreToolUse",
      "source": "claude",
      "session_id": "abc123",
      "cwd": "/Users/user/project",
      "tool_name": "Bash",
      "tool_input": {
        "command": "npm test"
      },
      "timestamp": "2025-01-15T10:30:00Z",
      "raw_payload": {}
    },
    {
      "event_type": "PreToolUse",
      "source": "cursor",
      "session_id": "",
      "cwd": "/Users/user/project",
      "tool_name": "Bash",
      "tool_input": {
        "command": "git status"
      },
      "timestamp": "",
      "raw_payload": {}
    }
  ]
}
